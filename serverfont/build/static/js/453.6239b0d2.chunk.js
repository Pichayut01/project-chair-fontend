"use strict";(self.webpackChunkweb_app_chair=self.webpackChunkweb_app_chair||[]).push([[453],{109:()=>{},200:(e,s,a)=>{e.exports=a.p+"static/media/nulluser.838b2604657754be4cd6.png"},485:(e,s,a)=>{a.d(s,{A:()=>p});var t=a(43);a(109);const i=a.p+"static/media/icon.88f7cef4fa136df22b4e.ico";var n=a(200),o=a(819),r=a(184),l=a(981),c=a(64),d=a.n(c),m=a(579);const h={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL||"http://localhost:5000",p=e=>{var s;let{isSidebarOpen:a,toggleSidebar:c,user:p,handleSignOut:u,onClassActionClick:x,classrooms:g,isClassroomPage:b,onShareClick:j,classroomMembers:N,isAccountSettingPage:f,onPromoteMember:v,onKickMember:C,onDemoteMember:y,classroom:S,isCreator:k,isEditing:_,onToggleEditMode:w,onSavePositions:P,onCancelEdit:E,userSeatId:R,onLeaveSeat:L}=e;const U=(0,l.Zp)(),[B,O]=(0,t.useState)(!1),T=e=>{e.target.onerror=null,e.target.src=n,console.warn("Navbar profile image failed to load, falling back to placeholder:",e.target.src)},A=()=>{U(-1)},D={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",display:"block"},F=e=>{N.creator.some(s=>s._id===e._id)?d().fire({title:e.displayName,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Demote to Participant",denyButtonText:"Kick",cancelButtonText:"Cancel",icon:"info",confirmButtonColor:"#e74c3c"}).then(async s=>{s.isConfirmed?await y(e._id,e.displayName):s.isDenied&&await C(e._id,e.displayName)}):d().fire({title:e.displayName,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Promote to Creator",denyButtonText:"Kick",cancelButtonText:"Cancel",icon:"info"}).then(async s=>{s.isConfirmed?await v(e._id,e.displayName):s.isDenied&&await C(e._id,e.displayName)})};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("nav",{className:"navbar",children:[(0,m.jsxs)("div",{className:"navbar__logo",children:[(0,m.jsx)("button",{className:"navbar__burger",onClick:c,children:"\u2630"}),(0,m.jsx)("img",{src:i,alt:"Logo",className:"navbar__logo-image"}),(0,m.jsx)("h1",{style:{color:"#414141ff",fontSize:"24px"},children:"Chair"})]}),(0,m.jsx)("div",{className:"navbar-center",children:b&&k&&(_?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("button",{className:"navbar-action-button save",onClick:P,title:"Save Seating",children:[(0,m.jsx)(o.Bc_,{size:20}),(0,m.jsx)("span",{children:"Save"})]}),(0,m.jsxs)("button",{className:"navbar-action-button cancel",onClick:E,title:"Cancel",children:[(0,m.jsx)(o.yGN,{size:20}),(0,m.jsx)("span",{children:"Cancel"})]})]}):(0,m.jsxs)("button",{className:"navbar-action-button",onClick:w,title:"Edit Seating",children:[(0,m.jsx)(o.WXf,{size:20}),(0,m.jsx)("span",{children:"Edit"})]}))}),(0,m.jsxs)("div",{className:"navbar__profile",onClick:()=>{O(!B)},children:[p?(0,m.jsx)("img",{src:p.photoURL?"".concat(h).concat(p.photoURL):n,alt:"User Profile",className:"navbar-profile-image",onError:T}):(0,m.jsx)("button",{onClick:()=>{U("/login")},className:"navbar__signin-button",children:"Sign In"}),B&&p&&(0,m.jsxs)("div",{className:"dropdown-menu",children:[(0,m.jsxs)("div",{className:"dropdown-user-info",children:[(0,m.jsx)("img",{src:p.photoURL?"".concat(h).concat(p.photoURL):n,alt:"User Profile",className:"dropdown-profile-image",onError:T}),(0,m.jsxs)("div",{className:"user-details",children:[(0,m.jsx)("span",{className:"user-name",children:p.displayName}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"user-email",children:p.email})]})]}),(0,m.jsx)("hr",{style:{border:"none",height:"1px",backgroundColor:"#dadce0",margin:"8px 0"}}),(0,m.jsxs)("div",{className:"dropdown-list",children:[(0,m.jsx)("span",{className:"dropdown-item",onClick:()=>{U("/account-setting"),O(!1)},children:"Account Setting"}),(0,m.jsxs)("span",{className:"dropdown-item",onClick:async()=>{await u(),O(!1),window.location.reload()},children:[(0,m.jsx)(o.QeK,{}),"Sign Out"]})]})]})]})]}),(0,m.jsx)("aside",{className:"sidebar ".concat(a?"open":""),children:(0,m.jsx)("ul",{className:"sidebar-list",children:f?(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-back-button",onClick:A,children:[(0,m.jsx)(o.kRp,{size:18}),(0,m.jsx)("span",{children:"Back"})]}):b?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-back-button",onClick:A,children:[(0,m.jsx)(o.kRp,{size:18}),(0,m.jsx)("span",{children:"Back"})]}),p&&(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-share-class",onClick:j,children:[(0,m.jsx)(o.Pum,{size:18}),(0,m.jsx)("span",{children:"Share Class"})]}),(null===N||void 0===N?void 0:N.creator)&&N.creator.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("hr",{className:"divider",style:{margin:"8px 0"}}),(0,m.jsxs)("h3",{className:"sidebar-section-title",children:["Creator (",N.creator.length,")"]}),N.creator.map(e=>(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-member-item",children:[(0,m.jsx)("img",{src:e.photoURL?"".concat(h).concat(e.photoURL):n,alt:e.displayName,onError:T,className:"sidebar-profile-image"}),(0,m.jsx)("span",{style:D,children:e.displayName}),k&&p.id!==e._id&&(0,m.jsx)("button",{className:"menu-btn",onClick:()=>F(e),title:"Member options",children:(0,m.jsx)(r.Pcn,{})})]},e._id))]}),(null===N||void 0===N||null===(s=N.participants)||void 0===s?void 0:s.length)>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("hr",{className:"divider",style:{margin:"8px 0"}}),(0,m.jsxs)("h3",{className:"sidebar-section-title",children:["Participants (",N.participants.filter(e=>!N.creator.some(s=>s._id===e._id)).length,")"]}),N.participants.filter(e=>!N.creator.some(s=>s._id===e._id)).map(e=>(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-member-item",children:[(0,m.jsx)("img",{src:e.photoURL?"".concat(h).concat(e.photoURL):n,alt:e.displayName,onError:T,className:"sidebar-profile-image"}),(0,m.jsx)("span",{style:D,children:e.displayName}),k&&p.id!==e._id&&(0,m.jsx)("button",{className:"menu-btn",onClick:()=>F(e),title:"Member options",children:(0,m.jsx)(r.Pcn,{})})]},e._id))]}),b&&R&&(0,m.jsx)("button",{className:"leave-seat-btn",style:{width:"90%",margin:"20px auto 10px auto",display:"block",background:"#f44336",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 0",fontWeight:"bold",cursor:"pointer"},onClick:L,children:"Leave Seat"})]}):(0,m.jsxs)(m.Fragment,{children:[p&&(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-create-class",onClick:x,children:[(0,m.jsx)(o.GGD,{size:18}),(0,m.jsx)("span",{children:"Class"})]}),(0,m.jsx)("hr",{style:{border:"none",height:"1px",backgroundColor:"#dadce0",margin:"8px 0"}}),g.length>0?g.map(e=>{var s;return(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-classroom-item",onClick:()=>{return s=e._id,U("/classroom/".concat(s)),void c();var s},children:[(0,m.jsx)("img",{src:null!==(s=e.creator)&&void 0!==s&&s.photoURL?"".concat(h).concat(e.creator.photoURL):n,alt:"Creator Profile",className:"sidebar-profile-image"}),(0,m.jsx)("span",{className:"sidebar-classroom-name",children:e.name})]},e._id)}):(0,m.jsx)("li",{className:"sidebar-no-class-text",children:"No classes joined."})]})})})]})}},648:(e,s,a)=>{a.r(s),a.d(s,{default:()=>d});var t=a(43),i=a(205);const n=async function(e,s){const a=await(t=e,new Promise((e,s)=>{const a=new Image;a.addEventListener("load",()=>e(a)),a.addEventListener("error",e=>s(e)),a.setAttribute("crossOrigin","anonymous"),a.src=t}));var t;const i=document.createElement("canvas"),n=i.getContext("2d");return i.width=s.width,i.height=s.height,n.drawImage(a,s.x,s.y,s.width,s.height,0,0,s.width,s.height),new Promise(e=>{i.toBlob(s=>{e(s)},"image/jpeg")})};var o=a(200),r=a(485),l=a(579);const c="http://localhost:5000",d=e=>{let{user:s,updateUserProfile:a,onSignOut:d,isSidebarOpen:m,toggleSidebar:h}=e;const[p,u]=(0,t.useState)(null),[x,g]=(0,t.useState)(s.photoURL),[b,j]=(0,t.useState)(!1),[N,f]=(0,t.useState)(""),[v,C]=(0,t.useState)(!1),[y,S]=(0,t.useState)({x:0,y:0}),[k,_]=(0,t.useState)(1),[w,P]=(0,t.useState)(null),[E,R]=(0,t.useState)(null),L=(0,t.useCallback)((e,s)=>{P(s)},[]),U=x?x.startsWith("blob:")?x:"".concat(c).concat(x):o;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.A,{isSidebarOpen:m,toggleSidebar:h,user:s,handleSignOut:d,isAccountSettingPage:!0}),(0,l.jsx)("main",{className:"main__content ".concat(m?"shift":""),children:(0,l.jsx)("div",{className:"account-setting-container",children:(0,l.jsxs)("div",{className:"setting-card",children:[(0,l.jsx)("h2",{children:"Account Settings"}),(0,l.jsxs)("div",{className:"profile-photo-section",children:[(0,l.jsx)("img",{src:U,alt:"Profile",className:"profile-photo"}),(0,l.jsxs)("div",{className:"photo-actions",children:[(0,l.jsxs)("label",{className:"file-upload-label",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(a){u(a);const e=new FileReader;e.onload=()=>{R(e.result),C(!0)},e.readAsDataURL(a)}else u(null),g(s.photoURL)},className:"file-upload-input",disabled:b}),(0,l.jsx)("span",{className:"file-upload-button",children:b?"Processing...":"Change Photo"})]}),s.photoURL&&(0,l.jsx)("button",{onClick:async()=>{j(!0),f("");try{const e=await fetch("".concat(c,"/api/auth/profile/delete-photo"),{method:"DELETE",headers:{"x-auth-token":s.token}}),t=await e.json();if(e.ok)a(t.user),g(null),f("Profile picture removed successfully!");else{const e="string"===typeof t.msg?t.msg:"Failed to remove profile picture.";f(e)}}catch(e){console.error("Error deleting profile photo:",e);const s="object"===typeof e&&e.message?e.message:"Server error. Please try again later.";f(s)}finally{j(!1)}},className:"remove-photo-button",disabled:b,children:"Remove Photo"})]})]}),N&&(0,l.jsx)("p",{className:"message",children:N}),(0,l.jsxs)("div",{className:"user-info-section",children:[(0,l.jsx)("h3",{children:"User Information"}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Name:"})," ",s.displayName]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Email:"})," ",s.email]})]}),(0,l.jsx)("div",{className:"action-buttons",children:(0,l.jsx)("button",{onClick:d,className:"sign-out-button",children:"Sign Out"})}),v&&(0,l.jsxs)("div",{className:"cropper-modal",children:[(0,l.jsx)("div",{className:"cropper-container",children:(0,l.jsx)(i.Ay,{image:E,crop:y,zoom:k,aspect:1,onCropChange:S,onZoomChange:_,onCropComplete:L})}),(0,l.jsxs)("div",{className:"cropper-controls",children:[(0,l.jsx)("input",{type:"range",value:k,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:e=>_(e.target.value),className:"zoom-slider"}),(0,l.jsx)("button",{onClick:()=>C(!1),className:"cancel-crop-button",children:"Cancel"}),(0,l.jsx)("button",{onClick:async()=>{j(!0),f(""),C(!1);try{const e=await n(E,w),t=new FormData;t.append("profileImage",e,p.name);const i=await fetch("".concat(c,"/api/auth/profile/update-photo"),{method:"POST",headers:{"x-auth-token":s.token},body:t}),o=await i.json();if(i.ok)a(o.user),g(o.user.photoURL),f("Profile picture updated successfully!");else{const e="string"===typeof o.msg?o.msg:"Failed to update profile picture.";f(e)}}catch(e){console.error("Error cropping or uploading photo:",e);const s="object"===typeof e&&e.message?e.message:"Server error. Please try again later.";f(s)}finally{j(!1),u(null),R(null)}},className:"crop-upload-button",children:"Crop & Upload"})]})]})]})})})]})}}}]);
//# sourceMappingURL=453.6239b0d2.chunk.js.map