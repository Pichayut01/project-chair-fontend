"use strict";(self.webpackChunkweb_app_chair=self.webpackChunkweb_app_chair||[]).push([[466],{11:()=>{},109:()=>{},192:()=>{},200:(e,s,t)=>{e.exports=t.p+"static/media/nulluser.838b2604657754be4cd6.png"},459:(e,s,t)=>{t.d(s,{A:()=>o});var a=t(43),i=(t(11),t(579));const o=e=>{let{id:s,initialPosition:t,onChairMove:o,containerRef:n,isDraggable:r,userPhotoURL:c,userName:l,onChairClick:d}=e;const[m,u]=(0,a.useState)(!1),[h,p]=(0,a.useState)(t),x=(0,a.useRef)({x:0,y:0}),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{p(t)},[t]);const b=(0,a.useCallback)(e=>{if(!r||!g.current)return;u(!0);const s=g.current.getBoundingClientRect();x.current={x:e.clientX-s.left,y:e.clientY-s.top}},[r]),v=(0,a.useCallback)(e=>{if(!m||!n.current||!g.current)return;const s=n.current.getBoundingClientRect(),t=g.current.getBoundingClientRect();let a=e.clientX-s.left-x.current.x,i=e.clientY-s.top-x.current.y;a=Math.max(0,Math.min(a,s.width-t.width)),i=Math.max(0,Math.min(i,s.height-t.height)),p({x:a,y:i})},[m,n]),f=(0,a.useCallback)(()=>{m&&(u(!1),o(s,h.x,h.y))},[m,o,s,h]);(0,a.useEffect)(()=>(m?(window.addEventListener("mousemove",v),window.addEventListener("mouseup",f)):(window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",f)),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",f)}),[m,v,f]);const C=(0,a.useCallback)(()=>{d&&!r&&d(s)},[s,r,d]);return(0,i.jsxs)("div",{ref:g,className:"chair-item",style:{left:h.x+"px",top:h.y+"px",zIndex:m?1e3:1},onMouseDown:b,onClick:C,children:[(0,i.jsx)("div",{className:"chair-icon",style:{backgroundImage:c?"url(".concat(c,")"):"none"},children:!c&&(0,i.jsx)("div",{className:"chair-icon-placeholder"})}),(0,i.jsx)("div",{className:"user-name-under",children:l||""})]})}},485:(e,s,t)=>{t.d(s,{A:()=>h});var a=t(43);t(109);const i=t.p+"static/media/icon.88f7cef4fa136df22b4e.ico";var o=t(200),n=t(819),r=t(184),c=t(981),l=t(64),d=t.n(l),m=t(579);const u={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL||"http://localhost:5000",h=e=>{var s;let{isSidebarOpen:t,toggleSidebar:l,user:h,handleSignOut:p,onClassActionClick:x,classrooms:g,isClassroomPage:b,onShareClick:v,classroomMembers:f,isAccountSettingPage:C,onPromoteMember:j,onKickMember:k,onDemoteMember:N,classroom:y,isCreator:w,isEditing:S,onToggleEditMode:_,onSavePositions:E,onCancelEdit:R,userSeatId:B,onLeaveSeat:P}=e;const T=(0,c.Zp)(),[L,A]=(0,a.useState)(!1),U=e=>{e.target.onerror=null,e.target.src=o,console.warn("Navbar profile image failed to load, falling back to placeholder:",e.target.src)},O=()=>{T(-1)},D={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",display:"block"},I=e=>{f.creator.some(s=>s._id===e._id)?d().fire({title:e.displayName,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Demote to Participant",denyButtonText:"Kick",cancelButtonText:"Cancel",icon:"info",confirmButtonColor:"#e74c3c"}).then(async s=>{s.isConfirmed?await N(e._id,e.displayName):s.isDenied&&await k(e._id,e.displayName)}):d().fire({title:e.displayName,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Promote to Creator",denyButtonText:"Kick",cancelButtonText:"Cancel",icon:"info"}).then(async s=>{s.isConfirmed?await j(e._id,e.displayName):s.isDenied&&await k(e._id,e.displayName)})};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("nav",{className:"navbar",children:[(0,m.jsxs)("div",{className:"navbar__logo",children:[(0,m.jsx)("button",{className:"navbar__burger",onClick:l,children:"\u2630"}),(0,m.jsx)("img",{src:i,alt:"Logo",className:"navbar__logo-image"}),(0,m.jsx)("h1",{style:{color:"#414141ff",fontSize:"24px"},children:"Chair"})]}),(0,m.jsx)("div",{className:"navbar-center",children:b&&w&&(S?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("button",{className:"navbar-action-button save",onClick:E,title:"Save Seating",children:[(0,m.jsx)(n.Bc_,{size:20}),(0,m.jsx)("span",{children:"Save"})]}),(0,m.jsxs)("button",{className:"navbar-action-button cancel",onClick:R,title:"Cancel",children:[(0,m.jsx)(n.yGN,{size:20}),(0,m.jsx)("span",{children:"Cancel"})]})]}):(0,m.jsxs)("button",{className:"navbar-action-button",onClick:_,title:"Edit Seating",children:[(0,m.jsx)(n.WXf,{size:20}),(0,m.jsx)("span",{children:"Edit"})]}))}),(0,m.jsxs)("div",{className:"navbar__profile",onClick:()=>{A(!L)},children:[h?(0,m.jsx)("img",{src:h.photoURL?"".concat(u).concat(h.photoURL):o,alt:"User Profile",className:"navbar-profile-image",onError:U}):(0,m.jsx)("button",{onClick:()=>{T("/login")},className:"navbar__signin-button",children:"Sign In"}),L&&h&&(0,m.jsxs)("div",{className:"dropdown-menu",children:[(0,m.jsxs)("div",{className:"dropdown-user-info",children:[(0,m.jsx)("img",{src:h.photoURL?"".concat(u).concat(h.photoURL):o,alt:"User Profile",className:"dropdown-profile-image",onError:U}),(0,m.jsxs)("div",{className:"user-details",children:[(0,m.jsx)("span",{className:"user-name",children:h.displayName}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"user-email",children:h.email})]})]}),(0,m.jsx)("hr",{style:{border:"none",height:"1px",backgroundColor:"#dadce0",margin:"8px 0"}}),(0,m.jsxs)("div",{className:"dropdown-list",children:[(0,m.jsx)("span",{className:"dropdown-item",onClick:()=>{T("/account-setting"),A(!1)},children:"Account Setting"}),(0,m.jsxs)("span",{className:"dropdown-item",onClick:async()=>{await p(),A(!1),window.location.reload()},children:[(0,m.jsx)(n.QeK,{}),"Sign Out"]})]})]})]})]}),(0,m.jsx)("aside",{className:"sidebar ".concat(t?"open":""),children:(0,m.jsx)("ul",{className:"sidebar-list",children:C?(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-back-button",onClick:O,children:[(0,m.jsx)(n.kRp,{size:18}),(0,m.jsx)("span",{children:"Back"})]}):b?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-back-button",onClick:O,children:[(0,m.jsx)(n.kRp,{size:18}),(0,m.jsx)("span",{children:"Back"})]}),h&&(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-share-class",onClick:v,children:[(0,m.jsx)(n.Pum,{size:18}),(0,m.jsx)("span",{children:"Share Class"})]}),(null===f||void 0===f?void 0:f.creator)&&f.creator.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("hr",{className:"divider",style:{margin:"8px 0"}}),(0,m.jsxs)("h3",{className:"sidebar-section-title",children:["Creator (",f.creator.length,")"]}),f.creator.map(e=>(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-member-item",children:[(0,m.jsx)("img",{src:e.photoURL?"".concat(u).concat(e.photoURL):o,alt:e.displayName,onError:U,className:"sidebar-profile-image"}),(0,m.jsx)("span",{style:D,children:e.displayName}),w&&h.id!==e._id&&(0,m.jsx)("button",{className:"menu-btn",onClick:()=>I(e),title:"Member options",children:(0,m.jsx)(r.Pcn,{})})]},e._id))]}),(null===f||void 0===f||null===(s=f.participants)||void 0===s?void 0:s.length)>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("hr",{className:"divider",style:{margin:"8px 0"}}),(0,m.jsxs)("h3",{className:"sidebar-section-title",children:["Participants (",f.participants.filter(e=>!f.creator.some(s=>s._id===e._id)).length,")"]}),f.participants.filter(e=>!f.creator.some(s=>s._id===e._id)).map(e=>(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-member-item",children:[(0,m.jsx)("img",{src:e.photoURL?"".concat(u).concat(e.photoURL):o,alt:e.displayName,onError:U,className:"sidebar-profile-image"}),(0,m.jsx)("span",{style:D,children:e.displayName}),w&&h.id!==e._id&&(0,m.jsx)("button",{className:"menu-btn",onClick:()=>I(e),title:"Member options",children:(0,m.jsx)(r.Pcn,{})})]},e._id))]}),b&&B&&(0,m.jsx)("button",{className:"leave-seat-btn",style:{width:"90%",margin:"20px auto 10px auto",display:"block",background:"#f44336",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 0",fontWeight:"bold",cursor:"pointer"},onClick:P,children:"Leave Seat"})]}):(0,m.jsxs)(m.Fragment,{children:[h&&(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-create-class",onClick:x,children:[(0,m.jsx)(n.GGD,{size:18}),(0,m.jsx)("span",{children:"Class"})]}),(0,m.jsx)("hr",{style:{border:"none",height:"1px",backgroundColor:"#dadce0",margin:"8px 0"}}),g.length>0?g.map(e=>{var s;return(0,m.jsxs)("li",{className:"sidebar-list-item sidebar-classroom-item",onClick:()=>{return s=e._id,T("/classroom/".concat(s)),void l();var s},children:[(0,m.jsx)("img",{src:null!==(s=e.creator)&&void 0!==s&&s.photoURL?"".concat(u).concat(e.creator.photoURL):o,alt:"Creator Profile",className:"sidebar-profile-image"}),(0,m.jsx)("span",{className:"sidebar-classroom-name",children:e.name})]},e._id)}):(0,m.jsx)("li",{className:"sidebar-no-class-text",children:"No classes joined."})]})})})]})}},527:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});var a=t(555),i=t(43),o=t(981),n=t(722),r=t(64),c=t.n(r),l=t(485),d=(t(109),t(192),t(200)),m=t(459),u=t(579);const h=e=>{let{open:s,onClose:t,onConfirm:a,defaultName:o}=e;const[n,r]=(0,i.useState)(o||"");return s?(0,u.jsx)("div",{className:"modal-backdrop",children:(0,u.jsxs)("div",{className:"modal",children:[(0,u.jsx)("h3",{children:"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e0a\u0e37\u0e48\u0e2d\u0e17\u0e35\u0e48\u0e08\u0e30\u0e19\u0e31\u0e48\u0e07"}),(0,u.jsx)("input",{type:"text",value:n,placeholder:"\u0e01\u0e23\u0e2d\u0e01\u0e0a\u0e37\u0e48\u0e2d",onChange:e=>r(e.target.value)}),(0,u.jsxs)("div",{style:{marginTop:16},children:[(0,u.jsx)("button",{onClick:()=>a(n),disabled:!n.trim(),children:"\u0e15\u0e01\u0e25\u0e07"}),(0,u.jsx)("button",{onClick:t,style:{marginLeft:8},children:"\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01"})]})]})}):null},p={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL||"http://localhost:5000",x=e=>{let{user:s,isSidebarOpen:t,toggleSidebar:r,handleSignOut:x}=e;const{classId:g}=(0,o.g)(),[b,v]=(0,i.useState)(null),[f,C]=(0,i.useState)(!0),[j,k]=(0,i.useState)(null),[N,y]=(0,i.useState)({}),[w,S]=(0,i.useState)(!1),[_,E]=(0,i.useState)({}),[R,B]=(0,i.useState)({}),[P,T]=(0,i.useState)(!1),[L,A]=(0,i.useState)(null),U=(0,i.useRef)(null),O=(0,i.useCallback)((e,s,t)=>{E(i=>(0,a.A)((0,a.A)({},i),{},{[e]:{x:s,y:t}}))},[]),D=e=>{if(w||M)return;const t=Object.keys(R).find(e=>{var t;return(null===(t=R[e])||void 0===t?void 0:t.userId)===s.id}),a=R[e];if(t||!a){if(!t&&!a)return A(e),void T(!0);if(t){if(t===e)return;if(!a)return void(window.confirm("Do you want to move to this seat?")&&(A(e),T(!0)));if(a)return void alert("Cannot move to this seat, it is already taken.")}}else alert("This seat is already taken.")},I=(0,i.useCallback)(async()=>{try{const e=await n.A.get("".concat(p,"/api/classrooms/").concat(g),{headers:{"x-auth-token":s.token}});v(e.data);const t=e.data.seatingPositions||{},a=e.data.assignedUsers||{};y(t),E(t),B(a),C(!1)}catch(e){k("Failed to load classroom details."),C(!1),console.error("Error fetching classroom details:",e)}},[g,s]);(0,i.useEffect)(()=>{if(!s||!s.token||!g)return;if(C(!0),I(),w)return;const e=setInterval(()=>{I()},2e3);return()=>clearInterval(e)},[g,s,I,w]);if(f)return(0,u.jsx)("div",{children:"Loading..."});if(j)return(0,u.jsx)("div",{children:j});if(!b)return(0,u.jsx)("div",{children:"Classroom not found."});const M=s&&(null===b||void 0===b?void 0:b.creator)&&(Array.isArray(b.creator)?b.creator.some(e=>e._id===s.id):b.creator._id===s.id),F=Object.keys(R).find(e=>{var t;return(null===(t=R[e])||void 0===t?void 0:t.userId)===s.id});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.A,{isSidebarOpen:t,toggleSidebar:r,user:s,onClassActionClick:()=>{},classrooms:[],handleSignOut:x,isClassroomPage:!0,onShareClick:()=>{b&&c().fire({title:"Class Code",html:'\n                <div style="background-color: #eaf6ea; border: 1px solid #d4ecd4; border-radius: 4px; padding: 12px 15px; text-align: center;">\n                    <p style="font-size: 1.2em; font-weight: bold; margin: 0;">'.concat(b.classCode,'</p>\n                </div>\n                <p style="margin-top: 15px; font-size: 0.9em; color: #555;">Give this code to your students so they can join this class.</p>\n            '),showCancelButton:!1,showConfirmButton:!0,confirmButtonText:"Copy Code",preConfirm:()=>{navigator.clipboard.writeText(b.classCode),c().showValidationMessage("Copied!")}})},classroomMembers:{creator:b.creator,participants:b.participants},isCreator:M,isEditing:w,onToggleEditMode:()=>{S(e=>!e)},onSavePositions:async()=>{try{await n.A.put("".concat(p,"/api/classrooms/").concat(g,"/seating"),{seatingPositions:_},{headers:{"x-auth-token":s.token}}),y(_),S(!1),c().fire("Saved!","Seating arrangement updated successfully.","success")}catch(j){console.error("Failed to save seating positions:",j),c().fire("Error","Failed to save seating arrangement.","error")}},onCancelEdit:()=>{S(!1),E(N)},userSeatId:F,onLeaveSeat:async()=>{if(!s)return;const e=Object.keys(R).find(e=>{var t;return(null===(t=R[e])||void 0===t?void 0:t.userId)===s.id});if(!e)return;const t=(0,a.A)({},R);delete t[e],B(t);try{await n.A.put("".concat(p,"/api/classrooms/").concat(g,"/seating"),{seatingPositions:N,assignedUsers:t},{headers:{"x-auth-token":s.token}}),I()}catch(i){alert("Failed to leave the seat.")}},onPromoteMember:async(e,t)=>{try{(await c().fire({title:"Promote ".concat(t," to Creator?"),text:"This user will gain the same permissions as the classroom owner.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Promote",cancelButtonText:"Cancel"})).isConfirmed&&(await n.A.put("".concat(p,"/api/classrooms/").concat(g,"/promote"),{userId:e},{headers:{"x-auth-token":s.token}}),c().fire("Success","".concat(t," has been promoted to Creator."),"success"),I())}catch(a){c().fire("Error","Could not promote the member.","error")}},onDemoteMember:async(e,t)=>{try{(await c().fire({title:"Demote ".concat(t,"?"),text:"This user will lose their Creator permissions.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e74c3c",cancelButtonColor:"#3085d6",confirmButtonText:"Demote",cancelButtonText:"Cancel"})).isConfirmed&&(await n.A.put("".concat(p,"/api/classrooms/").concat(g,"/demote"),{userId:e},{headers:{"x-auth-token":s.token}}),c().fire("Success","".concat(t," has been demoted to a participant."),"success"),I())}catch(o){var a,i;c().fire("Error",(null===(a=o.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.msg)||"Could not demote the member.","error")}},onKickMember:async(e,t)=>{if((await c().fire({title:"Kick ".concat(t," from the classroom?"),text:"This user will be removed from the classroom.",icon:"warning",showCancelButton:!0,confirmButtonText:"Kick",cancelButtonText:"Cancel",confirmButtonColor:"#e74c3c"})).isConfirmed)try{await n.A.put("".concat(p,"/api/classrooms/").concat(g,"/kick"),{userId:e},{headers:{"x-auth-token":s.token}}),c().fire("Success","".concat(t," has been kicked from the classroom."),"success"),I()}catch(a){c().fire("Error","Could not kick the member.","error")}},classroom:b,user:s}),(0,u.jsxs)("main",{className:"main__content ".concat(t?"shift":""),children:[(0,u.jsxs)("div",{className:"classroom-header",style:{borderLeftColor:b.color},children:[(0,u.jsx)("h1",{children:b.name}),(0,u.jsx)("p",{children:b.subname})]}),(0,u.jsx)("div",{className:"classroom-details-container",children:(0,u.jsxs)("div",{className:"seating-chart-section",children:[(0,u.jsx)("h2",{className:"section-title",children:"Seating Arrangement"}),(()=>{if(!N||0===Object.keys(N).length)return(0,u.jsx)("div",{className:"no-seating-chart",children:"No seating chart available."});const e=Object.entries(w?_:N);return(0,u.jsx)("div",{className:"seating-grid",ref:U,style:{position:"relative",width:"100%",height:"800px",border:"1px solid #ccc"},children:e.map(e=>{let[s,t]=e;const a=R[s],i=null!==a&&void 0!==a&&a.photoURL?"".concat(p).concat(a.photoURL):d,o=(null===a||void 0===a?void 0:a.userName)||null;return(0,u.jsx)(m.A,{id:s,initialPosition:t,onChairMove:O,containerRef:U,isDraggable:w,userPhotoURL:i,userName:o,onChairClick:D},s)})})})()]})})]}),(0,u.jsx)(h,{open:P,onClose:()=>T(!1),onConfirm:async e=>{if(!L||!s)return;const t=Object.keys(R).find(e=>{var t;return(null===(t=R[e])||void 0===t?void 0:t.userId)===s.id}),i=(0,a.A)({},R);t&&delete i[t],i[L]={userName:e,userId:s.id,photoURL:s.photoURL},B(i),T(!1);try{await n.A.put("".concat(p,"/api/classrooms/").concat(g,"/seating"),{seatingPositions:N,assignedUsers:i},{headers:{"x-auth-token":s.token}}),I()}catch(o){alert("Save failed.")}},defaultName:null===s||void 0===s?void 0:s.displayName})]})}}}]);
//# sourceMappingURL=466.6958ea8d.chunk.js.map